<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Cartas individuales | Luzzzen Cards</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="style.css">
</head>

<body>

  <header>
    <a href="index.html" class="volver">← Volver al inicio</a>
    <h1>Cartas individuales</h1>
    <p>Cartas de fútbol disponibles</p>
  </header>

  <main>

    <section id="productos">

      <div class="catalogo">

        <!-- CARTA 1 -->
        <div class="carta">
          <div class="imagenes-carta">
          <img src="imagenes/HazardPruebaFront.jpg" alt="Hazard ejemplo adelante">
          <img src="imagenes/HazardPruebaBack.jpg" alt="Hazard ejemplo atras">
        </div>
  <h4 class="titulo-carta">
    Hazard - Chelsea – Panini WCCF 2016
  </h4>
  <p class="precio">$7.500</p>
  <button class="agregar">Agregar al pedido</button>
</div>

        <!-- CARTA 2 -->
        <div class="carta">
          <div class="imagenes-carta">
          <img src="imagenes/HazardPruebaFront.jpg" alt="Hazard ejemplo adelante">
          <img src="imagenes/HazardPruebaBack.jpg" alt="Hazard ejemplo atras">
        </div>
  <h4 class="titulo-carta">
    Didier Drogba – Panini Colección 2016
  </h4>
  <p class="precio">$5.000</p>
  <button class="agregar">Agregar al pedido</button>
</div>

      </div>
    </section>

    <!-- PEDIDO -->
   <section id="pedido">
  <h2>Tu pedido</h2>
  <ul id="lista-pedido"></ul>
  <p id="total">Total: $0</p>

  <button id="vaciar">Vaciar pedido</button>
  <button id="whatsapp">Enviar pedido por WhatsApp</button>
</section>

  </main>

  <div id="modal" class="modal">
  <button class="flecha izquierda">‹</button>
  <img id="modal-img">
  <button class="flecha derecha">›</button>
</div>


  <script>
/* ===============================
   VARIABLES GENERALES
================================ */

const botones = document.querySelectorAll(".agregar");
const listaPedido = document.getElementById("lista-pedido");
const totalTexto = document.getElementById("total");
const botonWhatsapp = document.getElementById("whatsapp");
const botonVaciar = document.getElementById("vaciar");

let total = 0;
let items = [];

/* ===============================
   AGREGAR AL PEDIDO
================================ */

botones.forEach(boton => {
  boton.addEventListener("click", () => {
    const carta = boton.parentElement;
    const nombre = carta.querySelector(".titulo-carta").innerText;
    const precioTexto = carta.querySelector(".precio").innerText;
    const precio = parseInt(precioTexto.replace(/\D/g, ""));

    // Evitar duplicados
    const yaExiste = items.some(item => item.nombre === nombre);
    if (yaExiste) {
      alert("Esta carta ya está en tu pedido.");
      return;
    }

    items.push({ nombre, precio });

    const item = document.createElement("li");
    item.innerHTML = `
      ${nombre} – ${precioTexto}
      <button class="eliminar">✕</button>
    `;
    listaPedido.appendChild(item);

    item.querySelector(".eliminar").addEventListener("click", () => {
      listaPedido.removeChild(item);
      total -= precio;
      totalTexto.innerText = `Total: $${total.toLocaleString()}`;
      items = items.filter(i => i.nombre !== nombre);
    });

    total += precio;
    totalTexto.innerText = `Total: $${total.toLocaleString()}`;
  });
});

/* ===============================
   VACIAR PEDIDO
================================ */

botonVaciar.addEventListener("click", () => {
  listaPedido.innerHTML = "";
  items = [];
  total = 0;
  totalTexto.innerText = "Total: $0";
});

/* ===============================
   ENVIAR POR WHATSAPP
================================ */

botonWhatsapp.addEventListener("click", () => {
  if (items.length === 0) {
    alert("No agregaste ninguna carta.");
    return;
  }

  const fecha = new Date();
  const codigo = `LZ-${fecha.getFullYear()}${fecha.getMonth() + 1}${fecha.getDate()}-${Math.floor(Math.random() * 1000)}`;

  let mensaje = `Pedido ${codigo}%0A%0A`;

  items.forEach(item => {
    mensaje += `• ${item.nombre} - $${item.precio.toLocaleString()}%0A`;
  });

  mensaje += `%0A Total: $${total.toLocaleString()}`;

  const numero = "5491125608635";
  const url = `https://wa.me/${numero}?text=${mensaje}`;

  window.open(url, "_blank");
});

/* ===============================
   MODAL DE IMÁGENES
================================ */

const modal = document.getElementById("modal");
const modalImg = document.getElementById("modal-img");
const flechaIzq = document.querySelector(".flecha.izquierda");
const flechaDer = document.querySelector(".flecha.derecha");

let imagenesActuales = [];
let indiceActual = 0;

// Abrir modal (siempre desde la imagen frontal)
document.querySelectorAll(".imagenes-carta").forEach(carta => {
  const imgs = carta.querySelectorAll("img");

  carta.addEventListener("click", () => {
    imagenesActuales = [...imgs];
    indiceActual = 0;
    modalImg.src = imagenesActuales[indiceActual].src;
    modal.style.display = "flex";
  });
});

// Flechas
flechaDer.addEventListener("click", e => {
  e.stopPropagation();
  indiceActual = (indiceActual + 1) % imagenesActuales.length;
  modalImg.src = imagenesActuales[indiceActual].src;
});

flechaIzq.addEventListener("click", e => {
  e.stopPropagation();
  indiceActual =
    (indiceActual - 1 + imagenesActuales.length) % imagenesActuales.length;
  modalImg.src = imagenesActuales[indiceActual].src;
});

// Evitar cierre al tocar imagen
modalImg.addEventListener("click", e => {
  e.stopPropagation();
});

// Cerrar solo tocando el fondo
modal.addEventListener("click", e => {
  if (e.target === modal) {
    modal.style.display = "none";
  }
});
</script>

</body>
</html>
